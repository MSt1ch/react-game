(this["webpackJsonpreact-game"]=this["webpackJsonpreact-game"]||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(7),u=n.n(c),l=(n(13),n(8)),s=n(2),i=(n(14),n(15),n(0));function o(e){var t=e.newGameHAndler,n=e.toggleFullScreen,a=e.fullScreenButtonValue;return Object(i.jsxs)("div",{className:"ControlPanel",children:[Object(i.jsx)("input",{type:"button",value:"New Game",className:" controlButton",onClick:function(){return t()}}),Object(i.jsx)("input",{type:"button",value:"Game Statistics",className:" controlButton"}),Object(i.jsx)("input",{type:"button",value:a,className:" controlButton",onClick:function(){n()}})]})}n(17),n(18);function d(e){return Object(i.jsxs)("div",{className:"Indicator",children:[Object(i.jsx)("div",{className:"Indicator-Name",children:e.name}),Object(i.jsx)("div",{className:"Indicator-Value",children:e.value})]})}var f="up",j="daown",m="left",v="right";function b(e){return(e<10?"0":"")+e.toString()}var h=100/85*100;function p(e){return Object(i.jsxs)("div",{className:"CurrentGameStatistics",children:[Object(i.jsx)(d,{name:"Time",value:"".concat(b(Math.floor(e.gameTime/60)),":").concat(b(e.gameTime%60||0))}),Object(i.jsx)(d,{name:"Moves",value:e.movedCells}),Object(i.jsx)(d,{name:"Merges",value:e.cellMerges}),Object(i.jsx)(d,{name:"Score",value:e.score})]})}n(19);function O(e){var t="";switch(e){case 2:t="#eee4da";break;case 4:t="#eee1c9";break;case 8:t="#f3b27a";break;case 16:t="#f69664";break;case 32:t="#f77c5f";break;case 64:t="#f75f3b";break;case 128:t="#edd073";break;case 256:t="#edcc62";break;default:t="rgba(238, 228, 218, 0.35)"}return t}function g(e,t){switch(e){case v:return t*h;case m:return-t*h;default:return 0}}function x(e,t){switch(e){case j:return t*h;case f:return-t*h;default:return 0}}function w(e){var t=e.gameCells,n=e.isCellAppearance,a=e.transitionDirection,c=e.cellAnimationEndHandler,u=e.cellTransitionEndHandler,l="".concat(100/Math.sqrt(t.length),"%"),s=r.a.useRef(null),o=r.a.useRef(!1),d=r.a.useRef(!1);return o.current=n,d.current=""!==a,Object(i.jsx)("div",{ref:s,className:"GameCanvas",onAnimationEnd:function e(){o.current&&(o.current=!1,c(),s.current&&s.current.removeEventListener("animationend",e))},onTransitionEnd:function e(){d.current&&(d.current=!1,u(),s.current&&s.current.removeEventListener("transitionend",e))},children:t.map((function(e,t){var r=a?e.prevValue:e.curValue,c=""!==a&&0!==e.path,u={color:null!==r&&r<8?"#776e65":"#f9f6f2",background:O(r),animation:n&&e.prevValue!==e.curValue&&e.curValue&&e.isUpdatedOrNew?"insertNewCells .3s linear":"",transform:c?"translate(".concat(g(a,e.path),"%, ").concat(x(a,e.path),"%)"):"",transition:c?"transform .3s":""};return Object(i.jsx)("div",{ref:s,className:"GameCanvas-CellWrapper",style:{width:l,height:l},children:Object(i.jsx)("div",{className:"GameCanvas-CellBackground",children:Object(i.jsx)("div",{className:"GameCanvas-Cell",style:u,children:r})})},t.toString())}))})}n(20);function N(e){return Math.round(10*e)/10}function V(e){return Object(i.jsxs)("div",{className:"SettingsWrapper",children:[Object(i.jsx)("div",{className:"settingsPanelName",children:"Settings:"}),Object(i.jsx)("div",{className:"Parameters",children:Object(i.jsxs)("div",{className:"Volume parameter",children:[" Volume level: ",b(10*N(e.volume)),Object(i.jsxs)("div",{className:"settingControls",children:[Object(i.jsx)("input",{type:"button",value:"+",className:"controlButton ",onClick:function(){return e.setvolume((function(e){return e<1?N(e)+.1:1}))}}),Object(i.jsx)("input",{type:"button",value:"-",className:"controlButton",onClick:function(){return e.setvolume((function(e){return e>0?N(e)-.1:0}))}}),Object(i.jsx)("input",{type:"button",value:"".concat(N(e.volume)?"OFF":"ON"),className:"controlButton",onClick:function(){return e.setvolume((function(e){return e?0:.5}))}})]})]})})]})}var C=n(4),k=n.p+"static/media/points.6a2a0b58.wav",S=n.p+"static/media/move.f1e4d610.wav",M=n.p+"static/media/click.49635200.mp3",A=n.p+"static/media/noChange.df3e968c.flac",E=[f,j,m,v];function y(e,t,n){for(var a,r=[],c=[],u=0;u<e.length;u++)null!==e[u].curValue&&c.push(u);for(var l=1;l<=t;l+=1)for(var s=!0;s;){var i=(a=Math.pow(n,2),Math.floor(Math.random()*a));c.includes(i)||(s=!1,c.push(i),r.push({indexForInsert:i,gameCell:Math.floor(10*Math.random())<9?{curValue:2,prevValue:null,isUpdatedOrNew:!0,path:0}:{curValue:4,prevValue:null,isUpdatedOrNew:!0,path:0}}))}return r.forEach((function(t){return e[t.indexForInsert]=t.gameCell})),e}function B(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=2,n=new Array(Math.pow(e,2)).fill({curValue:null,prevValue:null,isUpdatedOrNew:!1,path:0}),a=0;a<n.length;a++)n[a]={curValue:null,prevValue:null,isUpdatedOrNew:!1,path:0};return n=y(n,t,e)}function G(){var e=r.a.useState((new Date).toISOString()),t=Object(s.a)(e,2),n=t[0],a=t[1],c=r.a.useState(0),u=Object(s.a)(c,2),d=u[0],b=u[1],h=r.a.useState(0),O=Object(s.a)(h,2),g=O[0],x=O[1],N=r.a.useState(0),G=Object(s.a)(N,2),I=G[0],U=G[1],F=r.a.useState(0),L=Object(s.a)(F,2),R=L[0],T=L[1],H=r.a.useState(B()),q=Object(s.a)(H,2),D=q[0],P=q[1],J=r.a.useState("Open in fullscreen"),W=Object(s.a)(J,2),_=W[0],z=W[1],K=r.a.useState(!0),Q=Object(s.a)(K,2),X=Q[0],Y=Q[1],Z=r.a.useState(""),$=Object(s.a)(Z,2),ee=$[0],te=$[1],ne=r.a.useRef(!1),ae=r.a.useRef(null),re=r.a.useState(1),ce=Object(s.a)(re,2),ue=ce[0],le=ce[1],se=Object(C.a)(k,{volume:ue}),ie=Object(s.a)(se,1)[0],oe=Object(C.a)(S,{volume:ue}),de=Object(s.a)(oe,1)[0],fe=Object(C.a)(M,{volume:ue}),je=Object(s.a)(fe,1)[0],me=Object(C.a)(A,{volume:ue}),ve=Object(s.a)(me,1)[0],be=r.a.useCallback((function(e){if(ne.current){ne.current=!1;var t=function(e){switch(e){case"ArrowUp":return f;case"ArrowDown":return j;case"ArrowRight":return v;case"ArrowLeft":return m;default:return""}}(e.key);if(E.includes(t)){var n=function(e,t){var n=e,a=!1,r=0,c=0,u=0,l=Math.sqrt(n.length),s=0,i=0,o=0,d=0;switch(t){case f:s=0,d=l-1,i=1,o=l;break;case j:s=n.length-l,d=n.length-1,i=1,o=-l;break;case m:s=0,d=n.length-l,i=l,o=1;break;case v:s=l-1,d=n.length-1,i=l,o=-1}n.forEach((function(e){return e.prevValue=e.curValue}));for(var b=s;b<=d;b+=i){for(var h=[],p=0;p<l;p++)h.push(b+o*p);for(var O=b+o;h.includes(O);O+=o){for(var g=0,x=!0;x;){var w=O-g*o,N=n[w],V=w-o,C=n[V];if(!N||!C||!h.includes(w)||!h.includes(V))break;N.curValue?void 0!==C&&(null===C.curValue||C.curValue===N.curValue&&!1===C.isUpdatedOrNew&&!1===N.isUpdatedOrNew)?(null===C.curValue?C.curValue=N.curValue:(C.curValue=2*C.curValue,C.isUpdatedOrNew=!0,r=+C.curValue,c+=1),N.curValue=null,n[O].path+=1,g+=1,a=!0):x=!1:g+=1}n[O].path>0&&(u+=1)}}return{isArrChanged:a,newArr:n,points:r,cellMerges:c,movedCells:u}}(D,t),a=n.isArrChanged,r=n.newArr,c=n.points,u=n.cellMerges,s=n.movedCells;a?(P(Object(l.a)(r)),te(t),b((function(e){return e+c})),x((function(e){return e+u})),U((function(e){return e+s})),c?ie():de()):(P(y(D,1,Math.sqrt(D.length))),Y(!0),ve())}}}),[D]);return r.a.useEffect((function(){return window.addEventListener("keydown",be),function(){return window.removeEventListener("keydown",be)}}),[be]),r.a.useEffect((function(){var e=setInterval((function(){return T((function(e){return Math.floor(e+1)}))}),1e3);return function(){return clearInterval(e)}}),[n]),Object(i.jsxs)("div",{ref:ae,className:"GameField",children:[Object(i.jsx)(V,{volume:ue,setvolume:le}),Object(i.jsx)(o,{newGameHAndler:function(){je(),P(B()),Y(!0),b(0),x(0),U(0),T(0),a((new Date).toISOString())},toggleFullScreen:function(){je(),document.fullscreenElement?(document.exitFullscreen(),z("Open in fullscreen")):null!==ae.current&&(ae.current.requestFullscreen(),z("Close fullscreen"))},fullScreenButtonValue:_}),Object(i.jsx)(p,{score:d,cellMerges:g,movedCells:I,gameTime:R}),Object(i.jsx)(w,{gameCells:D,isCellAppearance:X,transitionDirection:ee,cellAnimationEndHandler:function(){Y(!1),P(D.map((function(e){return e.prevValue=null,e.isUpdatedOrNew=!1,e.path=0,e}))),ne.current=!0},cellTransitionEndHandler:function(){P(y(D,1,Math.sqrt(D.length))),Y(!0),te("")}})]})}n(21);var I=n.p+"static/media/rs_school_js.ad178c0d.svg",U=n.p+"static/media/github.8eebd666.png";function F(){return Object(i.jsxs)("footer",{children:[Object(i.jsx)("a",{href:"https://rs.school/js/",target:"blank",children:Object(i.jsxs)("div",{children:[Object(i.jsx)("img",{src:I,alt:"schoolLogo"}),"RSS-School"]})}),Object(i.jsx)("a",{href:"https://github.com/thrvrce/react-game",target:"blank",children:Object(i.jsxs)("div",{children:[Object(i.jsx)("img",{src:U,alt:"githubLogo"}),"Viktor Avdeev"]})}),Object(i.jsx)("div",{children:"2021"})]})}u.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsxs)("div",{className:"mainContent",children:[Object(i.jsx)(G,{}),Object(i.jsx)(F,{})]})}),document.getElementById("root"))}],[[22,1,2]]]);
//# sourceMappingURL=main.ec0c0b9e.chunk.js.map
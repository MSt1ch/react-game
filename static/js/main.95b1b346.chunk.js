(this["webpackJsonpreact-game"]=this["webpackJsonpreact-game"]||[]).push([[0],{13:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(7),s=a.n(r),l=(a(13),a(8)),u=a(2),i=a(0);function o(e){var t=e.newGameHAndler,a=e.toggleFullScreen,n=e.fullScreenButtonValue,c=e.autoplayHandler,r=e.togleSavedGamesStatisticsVsibility;return Object(i.jsxs)("div",{className:"ControlPanel",children:[Object(i.jsx)("input",{type:"button",value:"New Game",className:" controlButton",onClick:function(){return t()}}),Object(i.jsx)("input",{type:"button",value:"Game Statistics",className:" controlButton",onClick:function(){r()}}),Object(i.jsx)("input",{type:"button",value:n,className:" controlButton",onClick:function(){a()}}),Object(i.jsx)("input",{type:"button",value:"Autoplay",className:"controlButton",onClick:function(){return c()}})]})}function d(e){return Object(i.jsxs)("div",{className:"Indicator",children:[Object(i.jsx)("div",{className:"Indicator-Name",children:e.name}),Object(i.jsx)("div",{className:"Indicator-Value",children:e.value})]})}var m="up",j="daown",f="left",b="right",h=100/85*100,v="saved2048Games",O=["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"],g="New game";function p(e){return(e<10?"0":"")+e.toString()}function x(e){return"".concat(p(Math.floor(e/60)),":").concat(p(e%60||0))}function S(e){return Object(i.jsxs)("div",{className:"CurrentGameStatistics",children:[Object(i.jsx)(d,{name:"Time",value:x(e.gameTime)}),Object(i.jsx)(d,{name:"Moves",value:e.movedCells}),Object(i.jsx)(d,{name:"Merges",value:e.cellMerges}),Object(i.jsx)(d,{name:"Score",value:e.score})]})}function V(e){var t="";switch(e){case 2:t="#eee4da";break;case 4:t="#eee1c9";break;case 8:t="#f3b27a";break;case 16:t="#f69664";break;case 32:t="#f77c5f";break;case 64:t="#f75f3b";break;case 128:t="#edd073";break;case 256:t="#edcc62";break;case 512:t="#edc850";break;case 1024:t="#edc53f";break;case 2048:t="#edc22e";break;default:t="rgba(0, 0, 0, 0)"}return t}function w(e,t){switch(e){case b:return t*h;case f:return-t*h;default:return 0}}function N(e,t){switch(e){case j:return t*h;case m:return-t*h;default:return 0}}function C(e){var t=e.gameCells,a=e.isCellAppearance,n=e.transitionDirection,r=e.cellAnimationEndHandler,s=e.cellTransitionEndHandler,l="".concat(100/Math.sqrt(t.length),"%"),u=c.a.useRef(null),o=c.a.useRef(!1),d=c.a.useRef(!1);return o.current=a,d.current=""!==n,Object(i.jsx)("div",{ref:u,className:"GameCanvas",onAnimationEnd:function e(){o.current&&(o.current=!1,r(),u.current&&u.current.removeEventListener("animationend",e))},onTransitionEnd:function e(){d.current&&(d.current=!1,s(),u.current&&u.current.removeEventListener("transitionend",e))},children:t.map((function(e,t){var c=n?e.prevValue:e.curValue,r=""!==n&&0!==e.path,s=2;c&&(c>512?s=1.2:c>64&&(s=1.6));var o={color:null!==c&&c<8?"#776e65":"#f9f6f2",background:V(c),animation:a&&e.prevValue!==e.curValue&&e.curValue&&e.isUpdatedOrNew?"insertNewCells .3s linear":"",transform:r?"translate(".concat(w(n,e.path),"%, ").concat(N(n,e.path),"%)"):"",transition:r?"transform .3s":"",fontSize:"".concat(s,"rem")};return Object(i.jsx)("div",{ref:u,className:"GameCanvas-CellWrapper",style:{width:l,height:l},children:Object(i.jsx)("div",{className:"GameCanvas-CellBackground",children:Object(i.jsx)("div",{className:"GameCanvas-Cell",style:o,children:c})})},t.toString())}))})}function M(e){return Math.round(10*e)/10}function y(e){return Object(i.jsxs)("div",{className:"SettingsWrapper",children:[Object(i.jsx)("div",{className:"settingsPanelName",children:"Settings:"}),Object(i.jsxs)("div",{className:"Parameters",children:[Object(i.jsxs)("div",{className:"Volume parameter",children:[" Volume level",Object(i.jsxs)("div",{className:"settingControls",children:[Object(i.jsx)("input",{type:"button",value:"+",className:"controlButton ",onClick:function(){return e.setVolume((function(e){return e<1?M(e)+.1:1}))}}),p(10*M(e.volume)),Object(i.jsx)("input",{type:"button",value:"-",className:"controlButton",onClick:function(){return e.setVolume((function(e){return e>0?M(e)-.1:0}))}})]}),Object(i.jsx)("input",{type:"button",value:"Sound ".concat(e.isEffectVolumeMuted?"OFF":"ON"),className:"controlButton",onClick:function(){return e.setisEffectVolumeMuted(!e.isEffectVolumeMuted)}}),Object(i.jsx)("input",{type:"button",value:"Music ".concat(e.ismusicVolumeMuted?"OFF":"ON"),className:"controlButton",onClick:function(){return e.setismusicVolumeMuted(!e.ismusicVolumeMuted)}})]}),Object(i.jsxs)("div",{children:[Object(i.jsxs)("div",{className:"GameParemetersWrapper",children:[Object(i.jsxs)("div",{className:"fieldSize parameter",children:[" Field size",Object(i.jsx)("div",{className:"settingControls",children:Object(i.jsxs)("select",{name:"fieldSize",className:"controlButton ",value:e.fieldSize,onChange:function(t){return e.fieldSizeSelecthandler(t.target.value)},children:[Object(i.jsx)("option",{value:3,children:"3"}),Object(i.jsx)("option",{value:4,children:"4"}),Object(i.jsx)("option",{value:5,children:"5"}),Object(i.jsx)("option",{value:6,children:"6"}),Object(i.jsx)("option",{value:7,children:"7"}),Object(i.jsx)("option",{value:8,children:"8"})]})})]}),Object(i.jsxs)("div",{className:"goal parameter",children:[" Current goal",Object(i.jsx)("div",{className:"settingControls",children:Object(i.jsxs)("select",{name:"goal",className:"controlButton ",value:e.goal,onChange:function(t){return e.goalHandler(t.target.value)},children:[Object(i.jsx)("option",{value:16,children:"16"}),Object(i.jsx)("option",{value:32,children:"32"}),Object(i.jsx)("option",{value:64,children:"64"}),Object(i.jsx)("option",{value:128,children:"128"}),Object(i.jsx)("option",{value:256,children:"256"}),Object(i.jsx)("option",{value:512,children:"512"}),Object(i.jsx)("option",{value:1024,children:"1024"}),Object(i.jsx)("option",{value:2048,children:"2048"}),Object(i.jsx)("option",{value:4096,children:"4096"}),Object(i.jsx)("option",{value:8192,children:"8192"}),Object(i.jsx)("option",{value:16384,children:"16384"}),Object(i.jsx)("option",{value:32768,children:"32768"}),Object(i.jsx)("option",{value:65536,children:"65536"})]})})]})]}),Object(i.jsxs)("div",{className:"autopilot parameter",children:["Game for autoplay",Object(i.jsx)("div",{className:"settingControls",children:Object(i.jsxs)("select",{name:"autopilot",className:"controlButton ",value:e.gameForAutoplay,onChange:function(t){return e.gameForAutoplayHandler(t.target.value)},children:[Object(i.jsx)("option",{value:g,children:"New game"}),Object(i.jsx)("option",{value:"Current game",children:"Current game"})]})})]})]})]})]})}function k(e){return Object(i.jsxs)("div",{className:"hiddenPAnel Message",style:{transform:e.isShowMessage?"translate(0%, 750%)":"",opacity:e.isShowMessage?"1":"0"},children:[Object(i.jsx)("div",{className:"MessageTitle",children:e.message}),Object(i.jsx)("input",{type:"button",className:"controlButton",value:"OK",onClick:function(){return e.messageOkHandler()}})]})}var A=a(3);function E(e){return Object(i.jsx)("div",{className:"savedGamesStat hiddenPAnel",style:{transform:e.isShowStatistics?"translate(0rem, 50rem)":"",opacity:e.isShowStatistics?"1":"0"},children:Object(i.jsxs)("table",{children:[Object(i.jsx)("caption",{children:"Previous ten games statistic"}),Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Game start time"}),Object(i.jsx)("th",{children:"Time"}),Object(i.jsx)("th",{children:"Moves"}),Object(i.jsx)("th",{children:"Merges"}),Object(i.jsx)("th",{children:"Score"})]})}),Object(i.jsx)("tbody",{children:function(){var t=e.getSavedGames();return t.length?t.map((function(e){var t=new Date(e.gameStartTime),a="".concat(t.getFullYear(),"/").concat(t.getMonth()+1,"/").concat(t.getDate()," ").concat(x(60*t.getHours()+t.getMinutes()));return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:a}),Object(i.jsx)("td",{children:x(e.gameTime)}),Object(i.jsx)("td",{children:e.movedCells}),Object(i.jsx)("td",{children:e.cellMerges}),Object(i.jsx)("td",{children:e.score})]},e.gameStartTime)})):Object(i.jsxs)("tr",{children:[" ",Object(i.jsx)("td",{colSpan:5,children:" No saved games! "})," "]})}()})]})})}var F=a.p+"static/media/points.6a2a0b58.wav",G=a.p+"static/media/move.f1e4d610.wav",T=a.p+"static/media/click.49635200.mp3",B=a.p+"static/media/noChange.df3e968c.flac",I=a.p+"static/media/loose.410bfa26.mp3",H=a.p+"static/media/victory.1806f59f.wav",z=a.p+"static/media/music.7ca942e2.mp3",U=[m,j,f,b];function D(e){return Math.floor(Math.random()*e)}function L(e,t,a){for(var n=[],c=[],r=0;r<e.length;r++)null!==e[r].curValue&&c.push(r);if(c.length!==e.length){for(var s=1;s<=t;s+=1)for(var l=!0;l;){var u=D(Math.pow(a,2));c.includes(u)||(l=!1,c.push(u),n.push({indexForInsert:u,gameCell:Math.floor(10*Math.random())<9?{curValue:2,prevValue:null,isUpdatedOrNew:!0,path:0}:{curValue:4,prevValue:null,isUpdatedOrNew:!0,path:0}}))}n.forEach((function(t){return e[t.indexForInsert]=t.gameCell}))}return e}function P(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t=2,a=new Array(Math.pow(e,2)).fill({curValue:null,prevValue:null,isUpdatedOrNew:!1,path:0}),n=0;n<a.length;n++)a[n]={curValue:null,prevValue:null,isUpdatedOrNew:!1,path:0};return a=L(a,t,e)}function R(e,t){var a=JSON.parse(JSON.stringify(e)),n=!1,c=0,r=0,s=0,l=Math.sqrt(a.length),u=0,i=0,o=0,d=0;switch(t){case m:u=0,d=l-1,i=1,o=l;break;case j:u=a.length-l,d=a.length-1,i=1,o=-l;break;case f:u=0,d=a.length-l,i=l,o=1;break;case b:u=l-1,d=a.length-1,i=l,o=-1}a.forEach((function(e){return e.prevValue=e.curValue}));for(var h=u;h<=d;h+=i){for(var v=[],O=0;O<l;O++)v.push(h+o*O);for(var g=h+o;v.includes(g);g+=o){for(var p=0,x=!0;x;){var S=g-p*o,V=a[S],w=S-o,N=a[w];if(!V||!N||!v.includes(S)||!v.includes(w))break;V.curValue?void 0!==N&&(null===N.curValue||N.curValue===V.curValue&&!1===N.isUpdatedOrNew&&!1===V.isUpdatedOrNew)?(null===N.curValue?N.curValue=V.curValue:(N.curValue=2*N.curValue,N.isUpdatedOrNew=!0,c=+N.curValue,r+=1),V.curValue=null,a[g].path+=1,p+=1,n=!0):x=!1:p+=1}a[g].path>0&&(s+=1)}}return{isArrChanged:n,newArr:a,points:c,cellMerges:r,movedCells:s}}function J(){var e=localStorage.getItem(v);return e?JSON.parse(e):[]}var q=function(e){var t=J();if(0!==t.length)return t[0][e];switch(e){case"gameStartTime":return(new Date).toISOString();case"score":case"cellMerges":case"movedCells":case"gameTime":return 0;case"fieldSize":return 4;case"gameCells":return P();case"goal":return 2048;case"musicVolume":case"efectsVolume":case"volume":return.5;case"isEffectVolumeMuted":case"ismusicVolumeMuted":return!1;case"gameForAutoplay":return g}};function W(e,t){return-1!==e.findIndex((function(e){return e.curValue===t}))}function K(){var e=c.a.useState(q("gameStartTime")),t=Object(u.a)(e,2),a=t[0],n=t[1],r=c.a.useState(q("score")),s=Object(u.a)(r,2),d=s[0],h=s[1],p=c.a.useState(q("cellMerges")),x=Object(u.a)(p,2),V=x[0],w=x[1],N=c.a.useState(q("movedCells")),M=Object(u.a)(N,2),K=M[0],Y=M[1],_=c.a.useState(q("gameTime")),Q=Object(u.a)(_,2),X=Q[0],Z=Q[1],$=c.a.useState(q("fieldSize")),ee=Object(u.a)($,2),te=ee[0],ae=ee[1],ne=c.a.useState(q("gameCells")),ce=Object(u.a)(ne,2),re=ce[0],se=ce[1],le=c.a.useState("Open in fullscreen"),ue=Object(u.a)(le,2),ie=ue[0],oe=ue[1],de=c.a.useState(!0),me=Object(u.a)(de,2),je=me[0],fe=me[1],be=c.a.useState(""),he=Object(u.a)(be,2),ve=he[0],Oe=he[1],ge=c.a.useState(!1),pe=Object(u.a)(ge,2),xe=pe[0],Se=pe[1],Ve=c.a.useState(!1),we=Object(u.a)(Ve,2),Ne=we[0],Ce=we[1],Me=c.a.useState(q("goal")),ye=Object(u.a)(Me,2),ke=ye[0],Ae=ye[1],Ee=c.a.useState(""),Fe=Object(u.a)(Ee,2),Ge=Fe[0],Te=Fe[1],Be=c.a.useState(q("volume")),Ie=Object(u.a)(Be,2),He=Ie[0],ze=Ie[1],Ue=c.a.useState(q("efectsVolume")),De=Object(u.a)(Ue,2),Le=De[0],Pe=De[1],Re=c.a.useState(q("musicVolume")),Je=Object(u.a)(Re,2),qe=Je[0],We=Je[1],Ke=c.a.useState(q("isEffectVolumeMuted")),Ye=Object(u.a)(Ke,2),_e=Ye[0],Qe=Ye[1],Xe=c.a.useState(q("ismusicVolumeMuted")),Ze=Object(u.a)(Xe,2),$e=Ze[0],et=Ze[1],tt=c.a.useState(!1),at=Object(u.a)(tt,2),nt=at[0],ct=at[1],rt=c.a.useState(q("gameForAutoplay")),st=Object(u.a)(rt,2),lt=st[0],ut=st[1],it=Object(A.a)(F,{volume:Le}),ot=Object(u.a)(it,1)[0],dt=Object(A.a)(G,{volume:Le}),mt=Object(u.a)(dt,1)[0],jt=Object(A.a)(T,{volume:Le}),ft=Object(u.a)(jt,1)[0],bt=Object(A.a)(B,{volume:Le}),ht=Object(u.a)(bt,1)[0],vt=Object(A.a)(I,{volume:Le}),Ot=Object(u.a)(vt,1)[0],gt=Object(A.a)(H,{volume:Le}),pt=Object(u.a)(gt,1)[0],xt=Object(A.a)(z,{volume:qe}),St=Object(u.a)(xt,2),Vt=St[0],wt=St[1],Nt=wt.isPlaying,Ct=wt.stop,Mt=c.a.useRef(!1),yt=c.a.useRef(null);c.a.useEffect((function(){Pe(_e?0:He),We($e?0:He)}),[He,_e,$e]);var kt=c.a.useCallback((function(e){if(Mt.current){Mt.current=!1;var t=function(e){switch(e){case"ArrowUp":return m;case"ArrowDown":return j;case"ArrowRight":return b;case"ArrowLeft":return f;default:return""}}(e.key);if(U.includes(t)){var a=R(re,t),n=a.isArrChanged,c=a.newArr,r=a.points,s=a.cellMerges,u=a.movedCells;n?(se(Object(l.a)(c)),Oe(t),h((function(e){return e+r})),w((function(e){return e+s})),Y((function(e){return e+u})),r?ot():mt()):W(re,null)?(se(L(re,1,Math.sqrt(re.length))),fe(!0),ht()):!function(e){for(var t=0;t<U.length;t++)if(R(e,U[t]).isArrChanged)return!0;return!1}(re)?(xe&&Se(!1),Te("You loose (no available moves)"),Ce(!0),Ot(),Mt.current=!0):(ht(),Mt.current=!0)}else Mt.current=!0}}),[re,ot,mt,ht,Ot,xe]),At=c.a.useCallback((function(){ft(),fe(!0),n((new Date).toISOString()),h(0),w(0),Y(0),Z(0),se(P(te))}),[te,ft]);return c.a.useEffect((function(){Mt.current=!0}),[]),c.a.useEffect((function(){return Vt(),function(){Ct()}}),[Vt,Nt,Ct]),c.a.useEffect((function(){return window.addEventListener("keydown",kt),function(){return window.removeEventListener("keydown",kt)}}),[kt]),c.a.useEffect((function(){var e=setInterval((function(){return Z((function(e){return Math.floor(e+1)}))}),1e3);return function(){return clearInterval(e)}}),[a]),c.a.useEffect((function(){var e;if(xe){e=setInterval((function(){return window.dispatchEvent(new KeyboardEvent("keydown",{key:O[D(4)]}))}),1e3)}return function(){return clearInterval(e)}}),[xe]),Object(i.jsxs)("div",{ref:yt,className:"GameField",children:[Object(i.jsx)(k,{isShowMessage:Ne,message:Ge,messageOkHandler:function(){Te(""),Ce(!1)}}),Object(i.jsx)(E,{getSavedGames:J,isShowStatistics:nt}),Object(i.jsx)(y,{volume:He,setVolume:ze,musicVolume:qe,setmusicVolume:We,isEffectVolumeMuted:_e,setisEffectVolumeMuted:Qe,ismusicVolumeMuted:$e,setismusicVolumeMuted:et,fieldSize:te,fieldSizeSelecthandler:function(e){ae(e)},goal:ke,goalHandler:function(e){Ae(e)},gameForAutoplay:lt,gameForAutoplayHandler:function(e){ut(e)}}),Object(i.jsx)(o,{newGameHAndler:function(){Se(!1),At()},toggleFullScreen:function(){ft(),document.fullscreenElement?(document.exitFullscreen(),oe("Open in fullscreen")):null!==yt.current&&(yt.current.requestFullscreen(),oe("Close fullscreen"))},fullScreenButtonValue:ie,autoplayHandler:function(){xe||lt===g&&At(),Se(!xe)},togleSavedGamesStatisticsVsibility:function(){ct(!nt)}}),Object(i.jsx)(S,{score:d,cellMerges:V,movedCells:K,gameTime:X}),Object(i.jsx)(C,{gameCells:re,isCellAppearance:je,transitionDirection:ve,cellAnimationEndHandler:function(){fe(!1),se(re.map((function(e){return e.prevValue=null,e.isUpdatedOrNew=!1,e.path=0,e}))),function(e){var t=J(),a=t.findIndex((function(t){return t.gameStartTime===e.gameStartTime}));-1!==a&&0===a?t[a]=e:(t.length>9&&t.pop(),t.unshift(e)),localStorage.setItem(v,JSON.stringify(t))}({gameCells:re,score:d,cellMerges:V,movedCells:K,gameTime:X,volume:He,fieldSize:te,gameStartTime:a,goal:ke,isEffectVolumeMuted:_e,ismusicVolumeMuted:$e,efectsVolume:Le,musicVolume:qe,gameForAutoplay:lt}),W(re,Number(ke))&&(pt(),xe?(Se(!1),Te("Wow, autoplay reach ".concat(ke,"!"))):Te("Goal ".concat(ke," reached! Try change goal and continue")),Ce(!0)),Mt.current=!0},cellTransitionEndHandler:function(){se(L(re,1,Math.sqrt(re.length))),fe(!0),Oe("")}})]})}var Y=a.p+"static/media/rs_school_js.ad178c0d.svg",_=a.p+"static/media/github.8eebd666.png";function Q(){return Object(i.jsxs)("footer",{children:[Object(i.jsx)("a",{href:"https://rs.school/js/",target:"blank",children:Object(i.jsxs)("div",{children:[Object(i.jsx)("img",{src:Y,alt:"schoolLogo"}),"RSS-School"]})}),Object(i.jsx)("a",{href:"https://github.com/thrvrce/react-game",target:"blank",children:Object(i.jsxs)("div",{children:[Object(i.jsx)("img",{src:_,alt:"githubLogo"}),"Viktor Avdeev"]})}),Object(i.jsx)("div",{children:"2021"})]})}s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsxs)("div",{className:"mainContent",children:[Object(i.jsx)(K,{}),Object(i.jsx)(Q,{})]})}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.95b1b346.chunk.js.map